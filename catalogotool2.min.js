window.agregarBotonera=function(){replicarNodo(qs("#btn-show-more"));let e=qs("#btn-show-more");e.innerText="Ver "+limiteReducido+" Más";e.addEventListener("click",verArticulos.bind(this,limiteReducido));let t=e.cloneNode(true);t.innerText="Ver "+limiteAmpliado+" Más";t.id="btn-show-much-more";t.addEventListener("click",verArticulos.bind(this,limiteAmpliado));e.parentNode.append(t);let o=qs("#available").parentNode;o.className="form-group col-xs-6 col-md-2";replicarNodo(o);o=qs("#available").parentNode;o.querySelector("label").htmlFor="available";let a=document.createElement("div");a.className="form-group col-xs-6 col-md-2";o.parentNode.append(a);let r=document.createElement("span");r.className="btn btn-outline";r.innerText="Buscar "+limiteReducido;a.append(r);r.addEventListener("click",reemplazarDisponibles.bind(this,limiteReducido));let l=document.createElement("div");l.className="form-group col-xs-6 col-md-2";o.parentNode.append(l);let i=document.createElement("span");i.className="btn btn-outline";i.innerText="Buscar Todo";l.append(i);i.addEventListener("click",reemplazarDisponibles.bind(this,0));let n=qs("#plf").parentNode;replicarNodo(n);let s=qs("#category").parentNode;qs("#category").style.display=null;bsmultiselect=qs(".dashboardcode-bsmultiselect");if(bsmultiselect){bsmultiselect.remove()}opciontodos=qs("#category option[value='all']");if(opciontodos){opciontodos.remove()}replicarNodo(s.parentNode);qs("#category option[value='home']").selected=true;qs("#category option[value='child']").selected=true;qs("#category option[value='sport']").selected=true;$("#category.form-control").bsMultiSelect();qs("#home").remove();qs("#child").remove();qs("#sport").remove();let c=o.cloneNode(true);let d=c.querySelector("input");d.name="caducahoy";d.id="caducahoy";d.checked=false;let u=c.querySelector("label");u.textContent="Caducan hoy:";u.htmlFor="caducahoy";o.parentNode.append(c);$("#caducahoy").on("click",fncFiltrarCaducanHoy);let p=o.cloneNode(true);let m=p.querySelector("input");m.name="invertir";m.id="invertir";m.checked=false;let f=p.querySelector("label");f.textContent="Orden inverso:";f.htmlFor="invertir";o.parentNode.append(p);$("#invertir").on("click",fncInvertirOrden);let b=document.createElement("div");b.className="form-group col-xs-6 col-md-2";o.parentNode.append(b);let v=document.createElement("span");v.className="btn btn-outline";v.id="boton-auto-refrescar";v.innerText="Auto Refrescar";b.append(v);v.addEventListener("click",iniciarAutoRefrescar);let h=document.createElement("div");h.className="form-group col-xs-6 col-md-2";o.parentNode.append(h);let q=document.createElement("span");q.className="btn btn-outline";q.id="boton-auto-capturar";q.innerText="Auto Capturar";h.append(q);q.addEventListener("click",iniciarAutoCapturar);let w=document.createElement("style");w.innerHTML=`#results{display:flex;flex-direction:row;flex-wrap:wrap;}
#results.invertir{flex-direction:row-reverse;flex-wrap:wrap-reverse;}
#results>div{display:block;flex-basis:33%;position:relative;padding:15px;}
#results .reservado form button[type='submit']{background-color:#18bc9c;pointer-events:none;}
#results .reservado>div{border:2px dashed #18bc9c;}
#results .perdido form button[type='submit']{background-color:black;pointer-events:none;}
#results .perdido>div{border:2px dashed black;}
.bloqueado {border:2px dashed silver;color:silver;pointer-events:none;}
@media only screen and (max-width:1000px){#results>div{flex-basis:50%;padding:5px;}}
@media only screen and (max-width:768px){#results>div{flex-basis:100%;padding:2px;}}`;document.getElementsByTagName("head")[0].appendChild(w)};window.borrarResultados=function(){let t=qsa("#results>div");for(let e=0;e<t.length;e++){t[e].remove()}let e=qs("#caducahoy");if(e&&e!=null){e.checked=false}let o=qs("#invertir");if(o&&o!=null){o.checked=false}};window.reemplazarDisponibles=function(e){borrarResultados();verArticulos(e)};window.iniciarAutoRefrescar=async function(){if(refrescarActivo){refrescarActivo=false;qs("#boton-auto-refrescar").textContent="Auto Refrescar";qs("#boton-auto-capturar").classList.remove("bloqueado")}else{refrescarActivo=true;qs("#boton-auto-refrescar").textContent="DETENER Auto Refrescar";qs("#boton-auto-capturar").classList.add("bloqueado")}window.capturar=false;comprobarReservaCatalogo()};window.iniciarAutoCapturar=async function(){if(refrescarActivo){refrescarActivo=false;qs("#boton-auto-capturar").textContent="Auto Capturar";qs("#boton-auto-refrescar").classList.remove("bloqueado")}else{refrescarActivo=true;qs("#boton-auto-capturar").textContent="DETENER Auto Capturar";qs("#boton-auto-refrescar").classList.add("bloqueado")}window.capturar=true;comprobarReservaCatalogo()};window.comprobarReservaCatalogo=async function(){let e=dameToken();let t={start:0,limit:limiteReducido};let o=$("#plf").val();if(o&&o!="none"){t["plf_id"]=o}if(qs("#category option[value='home']").selected){t["home"]="checked"}if(qs("#category option[value='child']").selected){t["child"]="checked"}if(qs("#category option[value='sport']").selected){t["sport"]="checked"}if(qs("#available").checked){t["available"]="checked"}let a={method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json","X-CSRF-TOKEN":e}};let r=await fetch(loc+"/web/catalogue/more",a);let l=await r.json();let i=l.data;chks++;mostrarCaducidadLoginReservas();let n=[];let s=[];let c=false;let d=false;let u=0;i.forEach((e,t)=>{if(!idsConocidos.includes(e.id)){idsConocidos.push(e.id);if(chks==1){n.push(e);return}s.unshift(e);if(t==0){c=true;if(window.capturar==true&&e.state=="PUBLICADO"){u=e.id}}else{d=true}}else{n.push(e)}});let p=s.concat(n);if(d||c){borrarResultados();l.data=p;webrender(l)}if(d){window.notificarAgudo()}if(c){window.notificar();if(u>0){let e=qs("#results .thumbnail-container form[action$='"+u+"'] button");e.click()}}if(refrescarActivo){try{tituloCatalogo=qs(".container .row h1");tituloCatalogo.textContent=textoTituloCatalogo+" - "+chks}catch(e){}try{document.title=ttl+" "+chks}catch(e){}setTimeout(comprobarReservaCatalogo,timeout)}else{try{tituloCatalogo=qs(".container .row h1");tituloCatalogo.textContent=textoTituloCatalogo}catch(e){}try{document.title=ttl}catch(e){}}};if(window.pulsado!=true){resultadosCatalogo=qs("#results");if(resultadosCatalogo){textoTituloCatalogo=qs(".container .row h1").textContent;let e=qs("#results");e.insertAdjacentHTML("afterend",'<div class="row" id="results2"></div>');if(qs("#caducahoy")==null){agregarBotonera()}reemplazarDisponibles(limiteReducido);window.pulsado=true}}