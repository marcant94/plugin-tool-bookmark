function t(e){var t=e.indexOf(textoBusqueda);return e.substring(0,t)}function o(e){var t=e.includes("Reservar");return comprobarLogin(e),t}function a(){var e;null==grecaptcha.execute||null==__recaptcha_api||1!=__google_recaptcha_client?setTimeout(a,50):((e=qs(".thumbnail-container-sm .thumbnail-action-lg form .btn-danger[type='button']")).focus(),e.click())}function e(){modo=timeoutNormal,timeout=timeoutNormal,c()}function n(){modo=timeoutLento,timeout=timeoutLento,c()}function r(){modo=timeoutRapido,timeout=timeoutRapido,c()}function i(){var e=document.location.pathname.split("/").pop();window.location.href="https://remadtools.twilightparadox.com/producto-capturar/"+e}function c(){qs("#boton-autoreservar").remove(),qs("#boton-autoreservar-lento").remove(),qs("#boton-autoreservar-rapido").remove(),qs("#boton-autoreservar-vps").remove(),u(),setInterval(s,6e4),setInterval(d,36e5),l(t(document.body.innerText))}function s(){var e,t;window.caducaHoy&&(e=(t=new Date).getHours(),t=t.getMinutes(),timeout=23==e&&58<=t||0==e&&t<=5?timeoutRapido:modo)}function d(){deboComprobarSiCaducaHoy=!0}function l(e){deboComprobarSiCaducaHoy=!1;var t=new Date;let o=t.getDate(),a=t.getMonth()+1;t=t.getFullYear(),o<10&&(o="0"+o),a<10&&(a="0"+a),t=o+"/"+a+"/"+t;window.caducaHoy=e.includes(t),s()}async function u(){var e=t(await(await fetch(webActual)).text());if(o(e))m();else{deboComprobarSiCaducaHoy&&l(e),chks++;try{tituloProducto.textContent=textoTituloProducto+" - "+chks}catch(e){}try{document.title=ttl+" "+chks}catch(e){}try{caducaHoy&&(tituloProducto.textContent+=textoCaducaHoy,document.title+=textoCaducaHoy)}catch(e){}setTimeout(u,timeout)}}function m(){qs(".thumbnail-container-sm .thumbnail-action-lg").innerHTML="";{let e=qs(".thumbnail-container-sm .thumbnail-action-lg"),t=document.createElement("form"),o=(t.method="POST",document.location.pathname.split("/").pop()),a=(t.id="reserve-form-"+o,t.action="https://www.remad.es/web/antiquity/reserve/"+o,e.append(t),document.createElement("input")),n=(a.name="g-recaptcha-response",a.hidden=!0,a.id="recaptcha-"+o,t.append(a),document.createElement("input")),r=(n.name="_token",n.type="hidden",n.value=dameToken(),t.append(n),document.createElement("button"));r.type="button",r.className="btn-danger btn-sm pull-left",r.addEventListener("click",()=>{reserveWithRecaptcha(o)}),r.innerText="Reservar con Recaptcha",t.append(r)}setTimeout(a,150)}function p(){reservableAlInicio&&m()}function v(){var e=document.createElement("script");e.src="https://www.remad.es/js/reCaptcha.js",e.addEventListener("load",p),document.head.appendChild(e)}var b,h;1!=window.pulsado&&(window.versionPlugin="Plugin v73",Cookies.set("_accept","true",{path:"/",expires:365}),$(".ty-settings").hide(),window.chks=0,window.loc=location.origin,window.webActual=loc+location.pathname,window.ttl=document.title,document.title=versionPlugin,window.qs=function(e){return document.querySelector(e)},window.qsa=function(e){return document.querySelectorAll(e)},window.dameToken=function(){return $('meta[name="csrf-token"]').attr("content")},window.comprobarLogin=async function(e="Acceso"){let t;return t=!!e.includes("Mi Perfil"),mostrarCaducidadLoginReservas(t),t},window.mostrarCaducidadLoginReservas=async function(e){chks%10==0&&(e?(e=(await(await fetch(loc+"/web/profile/myproducts")).text()).split('id="res-').length-1,qs(".header").textContent="Tiene "+e+" reservas"):qs(".header").textContent="NO hay sesión")},qs(".nav.navbar-nav.navbar-right li a").innerText=versionPlugin),tokenRemadV3="6LdZzrUpAAAAACe-NKn5XkSyTdAIrbLbp73d8R2F",textoBusqueda="Productos disponibles",textoCaducaHoy=" (Caduca hoy)",1!=window.pulsado&&(window.tituloProducto=qs(".thumbnail-title h1"),window.existeBotonReservar=qs("#boton-autoreservar"),tituloProducto)&&!existeBotonReservar&&(h=t(document.body.innerText),window.reservableAlInicio=o(h),window.timeoutNormal=500,window.timeoutLento=1500,window.timeoutRapido=250,window.modo=window.timeoutLento,window.deboComprobarSiCaducaHoy=!1,window.textoTituloProducto=tituloProducto?tituloProducto.textContent:"#producto#",(h=document.createElement("script")).src="https://www.google.com/recaptcha/api.js?render="+tokenRemadV3,h.addEventListener("load",v),document.head.appendChild(h),reservableAlInicio||((h=document.createElement("div")).className="form-group col-xs-12 col-md-6",tituloProducto.parentNode.append(h),(b=document.createElement("span")).className="btn btn-outline",b.id="boton-autoreservar",b.innerText="Modo Normal ("+timeoutNormal+"ms)",h.append(b),b.addEventListener("click",e),(h=document.createElement("div")).className="form-group col-xs-12 col-md-6",tituloProducto.parentNode.append(h),(b=document.createElement("span")).className="btn btn-outline",b.id="boton-autoreservar-lento",b.innerText="Modo Lento/Sin WiFi ("+timeoutLento+"ms)",h.append(b),b.addEventListener("click",n),(h=document.createElement("div")).className="form-group col-xs-12 col-md-6",tituloProducto.parentNode.append(h),(b=document.createElement("span")).className="btn btn-outline",b.id="boton-autoreservar-rapido",b.innerText="Modo Rápido/Renovar ("+timeoutRapido+"ms)",h.append(b),b.addEventListener("click",r),(h=document.createElement("div")).className="form-group col-xs-12 col-md-6",tituloProducto.parentNode.append(h),(b=document.createElement("span")).className="btn btn-outline",b.id="boton-autoreservar-vps",b.innerText="Captura con VPS",h.append(b),b.addEventListener("click",i)),window.pulsado=!0),pathNuevo=loc+"/./file/thumbnail",limiteReducido=30,limiteAmpliado=100,limiteTotal=1e6,timeout=500,idsConocidos=[],window.notificar=function(){window.avisar(),window.setTimeout(window.avisar,150),window.setTimeout(window.avisar,300)},window.avisar=function(){window.generarPitido(1200,.2)},window.generarPitido=function(e,t){var o=new(window.AudioContext||window.webkitAudioContext),a=o.createOscillator(),e=(a.frequency.setValueAtTime(e,o.currentTime),o.createGain());e.gain.setValueAtTime(.1,o.currentTime),a.connect(e),e.connect(o.destination),a.start(),a.stop(o.currentTime+t)},window.webrender=function(t){var o=dameToken();for(let e=0;e<t.data.length;e++){var a=t.data[e],a=$('<div class="thumbnail-container"><div class="thumbnail thumbnail-height"><a style="color:black;" href="'+loc+"/web/antiquity/"+a.id+'"><img src="'+pathNuevo+"/"+a.file_id+'" alt="" class="img-responsive"></a><div class="thumbnail-body"><h3><a style="color:black;" href="'+loc+"/web/antiquity/"+a.id+'">'+a.short_name+'</a></h3><p><span class="block-ellipsis"><strong>Categoría:</strong> '+a.category.name+'</span> <br><span class="block-ellipsis"><strong>Ubicación:</strong> '+a.plf.name+'</span></p></div><div class="thumbnail-action">'+("RESERVADO"==a.state?'<p class="pull-left" style="font-size: 17px;position: absolute;bottom: 40px;"><strong class="text-danger">Producto Reservado</strong><br>Hasta el '+a.expire_date+"</p>":'<form id="reserve-form-'+a.id+'" action="'+loc+"/web/antiquity/reserve/"+a.id+'" method="POST"><input type="hidden" name="_token" value="'+o+'"><input hidden="" name="g-recaptcha-response" id="recaptcha-'+a.id+'"><button type="button" onclick="reserveWithRecaptcha(\''+a.id+'\')" class="btn-danger btn-sm pull-left thumbnail-action-button" data-toggle="tooltip" data-placement="top" title="" data-bs-original-title="Click para reservar">Reservar</button></form>')+'<form action="'+loc+"/web/antiquity/favorite/"+a.id+'" method="POST"><input type="hidden" name="_token" value="'+o+'"><button type="submit" class="thumbnail-action-button-right" style="border-color: transparent; background-color: transparent; color: #dc4405;" data-toggle="tooltip" data-placement="top"title="Click para '+(a.favorite?"eliminar de favoritos":"añadir a favoritos")+'"><i class="fa '+(a.favorite?"fa-heart":"fa-heart-o")+' fa-2x"></i></button></form></div></div></div>');$("#results").append(a)}},window.comprobarArticulo=function(e,t){var o=new Date;let a=o.getDate(),n=o.getMonth()+1;o=o.getFullYear(),a<10&&(a="0"+a),n<10&&(n="0"+n),o=a+"/"+n+"/"+o;0<=t.innerText.indexOf(o)?t.classList.remove("hide"):t.classList.add("hide")},window.verArticulos=function(t){qs("#btn-show-more").classList.add("bloqueado"),qs("#btn-show-much-more").classList.add("bloqueado");var e=dameToken(),o={},a=(0==t?(o.start=0,o.limit=limiteTotal):(o.start=qsa("#results>div").length,o.limit=t),$("#plf").val());a&&"none"!=a&&(o.plf_id=$("#plf").val()),qs("#category option[value='home']").selected&&(o.home="checked"),qs("#category option[value='child']").selected&&(o.child="checked"),qs("#category option[value='sport']").selected&&(o.sport="checked"),qs("#available").checked&&(o.available="checked"),$.ajaxSetup({headers:{"X-CSRF-TOKEN":e}}),$.ajax({method:"POST",url:loc+"/web/catalogue/more",dataType:"json",data:o,success:function(e){0==t?(borrarResultados(),qs("#btn-show-more").classList.add("bloqueado"),qs("#btn-show-much-more").classList.add("bloqueado")):(qs("#btn-show-more").classList.remove("bloqueado"),qs("#btn-show-much-more").classList.remove("bloqueado")),0<e.data.length&&webrender(e),idPrimerArticulo=parseInt(qs("#results .thumbnail-container a").href.split("/").slice(-1)[0])},error:function(e){}})},window.fncFiltrarCaducanHoy=function(){var t=qsa("#results>div");if(qs("#caducahoy").checked)for(let e=0;e<t.length;e++){var o=t[e];comprobarArticulo(e,o)}else for(let e=0;e<t.length;e++)t[e].classList.remove("hide")},window.fncInvertirOrden=function(){var e=qs("#results");qs("#invertir").checked?e.classList.add("invertir"):e.classList.remove("invertir")},window.replicarNodo=function(e){var t=e.cloneNode(!0);e.parentNode.replaceChild(t,e)},window.agregarBotonera=function(){replicarNodo(qs("#btn-show-more"));var e=qs("#btn-show-more"),t=(e.innerText="Ver "+limiteReducido+" Más",e.addEventListener("click",verArticulos.bind(this,limiteReducido)),e.cloneNode(!0));t.innerText="Ver "+limiteAmpliado+" Más",t.id="btn-show-much-more",t.addEventListener("click",verArticulos.bind(this,limiteAmpliado)),e.parentNode.append(t);let o=qs("#available").parentNode;o.className="form-group col-xs-6 col-md-2",replicarNodo(o),(o=qs("#available").parentNode).querySelector("label").htmlFor="available";e=document.createElement("div"),e.className="form-group col-xs-6 col-md-2",o.parentNode.append(e),t=document.createElement("span"),t.className="btn btn-outline",t.innerText="Buscar "+limiteReducido,e.append(t),t.addEventListener("click",reemplazarDisponibles.bind(this,limiteReducido)),e=document.createElement("div"),e.className="form-group col-xs-6 col-md-2",o.parentNode.append(e),t=document.createElement("span"),t.className="btn btn-outline",t.innerText="Buscar Todo",e.append(t),t.addEventListener("click",reemplazarDisponibles.bind(this,0)),e=qs("#plf").parentNode,replicarNodo(e),t=qs("#category").parentNode,qs("#category").style.display=null,(bsmultiselect=qs(".dashboardcode-bsmultiselect"))&&bsmultiselect.remove(),(opciontodos=qs("#category option[value='all']"))&&opciontodos.remove(),replicarNodo(t.parentNode),qs("#category option[value='home']").selected=!0,qs("#category option[value='child']").selected=!0,qs("#category option[value='sport']").selected=!0,$("#category.form-control").bsMultiSelect(),qs("#home").remove(),qs("#child").remove(),qs("#sport").remove(),e=o.cloneNode(!0),t=e.querySelector("input"),t.name="caducahoy",t.id="caducahoy",t.checked=!1,t=e.querySelector("label"),t.textContent="Caducan hoy:",t.htmlFor="caducahoy",o.parentNode.append(e),$("#caducahoy").on("click",fncFiltrarCaducanHoy),t=o.cloneNode(!0),e=t.querySelector("input"),e.name="invertir",e.id="invertir",e.checked=!1,e=t.querySelector("label"),e.textContent="Orden inverso:",e.htmlFor="invertir",o.parentNode.append(t),$("#invertir").on("click",fncInvertirOrden),e=document.createElement("div"),e.className="form-group col-xs-6 col-md-2",o.parentNode.append(e),t=document.createElement("span"),t.className="btn btn-outline",t.id="boton-auto-refrescar",t.innerText="Auto Refrescar",e.append(t),t.addEventListener("click",iniciarAutoRefrescar),e=document.createElement("div"),e.className="form-group col-xs-6 col-md-2",o.parentNode.append(e),t=document.createElement("span"),t.className="btn btn-outline",t.id="boton-auto-capturar",t.innerText="Auto Capturar",e.append(t),t.addEventListener("click",iniciarAutoCapturar),e=document.createElement("style");e.innerHTML=`#results{display:flex;flex-direction:row;flex-wrap:wrap;}
#results.invertir{flex-direction:row-reverse;flex-wrap:wrap-reverse;}
#results>div{display:block;flex-basis:33%;position:relative;padding:15px;}
#results .reservado form button[type='submit']{background-color:#18bc9c;pointer-events:none;}
#results .reservado>div{border:2px dashed #18bc9c;}
#results .perdido form button[type='submit']{background-color:black;pointer-events:none;}
#results .perdido>div{border:2px dashed black;}
.bloqueado {border:2px dashed silver;color:silver;pointer-events:none;}
@media only screen and (max-width:1000px){#results>div{flex-basis:50%;padding:5px;}}
@media only screen and (max-width:768px){#results>div{flex-basis:100%;padding:2px;}}`,document.getElementsByTagName("head")[0].appendChild(e)},window.borrarResultados=function(){var t=qsa("#results>div");for(let e=0;e<t.length;e++)t[e].remove();var e=qs("#caducahoy"),e=(e&&null!=e&&(e.checked=!1),qs("#invertir"));e&&null!=e&&(e.checked=!1)},window.reemplazarDisponibles=function(e){borrarResultados(),verArticulos(e)},window.iniciarAutoRefrescar=async function(){qs("#boton-auto-refrescar").classList.add("bloqueado"),qs("#boton-auto-capturar").remove(),window.capturar=!1,comprobarReservaCatalogo()},window.iniciarAutoCapturar=async function(){qs("#boton-auto-refrescar").remove(),qs("#boton-auto-capturar").classList.add("bloqueado"),window.capturar=!0,comprobarReservaCatalogo()},window.comprobarReservaCatalogo=async function(){let t=webActual,o=!1;var e=qs("#plf").value;"none"!=e&&0<e&&(o?t+="&":(o=!0,t+="?"),t+="plf_id="+e);qsa("#category option").forEach(e=>{e.selected&&(o?t+="&":(o=!0,t+="?"),t=(t+="category="+e.value)+"&"+e.value+"=on")});e=qs("#available").checked;1==e&&(o?t+="&":(o=!0,t+="?"),t+="available="+e);var e=await(await fetch(t)).text(),a=e.indexOf("antiquity/favorite"),n=e.substring(0,a),n=(comprobarLogin(n),n.includes("Reservar")),a=e.substring(a+19),a=parseInt(a.substring(0,a.indexOf('" method="POST"')));if(chks++,n&&a>idPrimerArticulo){idPrimerArticulo=a;var n=e.indexOf('<div class="row" id="results">'),r=e.indexOf('<div class="row">',n+30),e=e.substring(n,r),n=qs("#invertir");n&&null!=n&&(n.checked=!1),window.notificar(),qs("#results").outerHTML=e,1==window.capturar&&qs("#results .thumbnail-container form[action$='"+a+"'] button").click()}else{try{(tituloCatalogo=qs(".container .row h1")).textContent=textoTituloCatalogo+" - "+chks}catch(e){}try{document.title=ttl+" "+chks}catch(e){}}setTimeout(comprobarReservaCatalogo,timeout)},1!=window.pulsado&&(resultadosCatalogo=qs("#results"))&&(textoTituloCatalogo=qs(".container .row h1").textContent,qs("#results").insertAdjacentHTML("afterend",'<div class="row" id="results2"></div>'),null==qs("#caducahoy")&&agregarBotonera(),reemplazarDisponibles(limiteReducido),window.pulsado=!0);